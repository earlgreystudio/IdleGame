# ç•°ä¸–ç•ŒIdleã‚²ãƒ¼ãƒ  - é–‹ç™ºã‚¬ã‚¤ãƒ‰

## ğŸ‘¨â€ğŸ’» ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç›®çš„

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ä½•ã®ãŸã‚ã«ã‚ã‚‹ã®ã‹ï¼š**
- é–‹ç™ºè€…ãŒå®ˆã‚‹ã¹ããƒ«ãƒ¼ãƒ«ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®šç¾©ã™ã‚‹
- ã‚³ãƒ¼ãƒ‰å“è³ªã®ä¸€è²«æ€§ã‚’ä¿ã¤ãŸã‚ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’æä¾›ã™ã‚‹
- æ–°ã—ã„é–‹ç™ºè€…ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‚åŠ ã—ã‚„ã™ãã™ã‚‹
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®åŸºæº–ã‚’æ˜ç¢ºã«ã™ã‚‹

**èª°ãŒä½¿ã†ã®ã‹ï¼š**
- æ–°è¦å‚åŠ ã®é–‹ç™ºè€…ï¼ˆé–‹ç™ºç’°å¢ƒæ§‹ç¯‰ãƒ»ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã®ç†è§£ï¼‰
- æ—¢å­˜é–‹ç™ºè€…ï¼ˆå®Ÿè£…æ™‚ã®ç¢ºèªãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®å‚è€ƒï¼‰
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼åŸºæº–ã¨ã—ã¦ï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ¼ãƒ€ãƒ¼ï¼ˆå“è³ªç®¡ç†ã®æŒ‡æ¨™ã¨ã—ã¦ï¼‰

**ã©ã‚“ãªæ™‚ã«å‚ç…§ã™ã‚‹ã®ã‹ï¼š**
- é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹æ™‚
- æ–°ã—ã„ã‚·ã‚¹ãƒ†ãƒ ãƒ»æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ™‚
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡Œã†æ™‚
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹æ™‚
- ã‚¨ãƒ©ãƒ¼ã‚„ãƒã‚°ã‚’ä¿®æ­£ã™ã‚‹æ™‚

---

## ğŸ“‹ ç›®æ¬¡

1. [é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
2. [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„](#ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„)
3. [ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ã‚¬ã‚¤ãƒ‰](#ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ã‚¬ã‚¤ãƒ‰)
4. [ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹æ€§ãƒ«ãƒ¼ãƒ«](#ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹æ€§ãƒ«ãƒ¼ãƒ«)
5. [UIé–‹ç™ºã‚¬ã‚¤ãƒ‰](#uié–‹ç™ºã‚¬ã‚¤ãƒ‰)
6. [ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°](#ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°)
7. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–)

---

## ğŸ› ï¸ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ãªç’°å¢ƒ
```bash
# Node.jsï¼ˆæ¨å¥¨: v18ä»¥ä¸Šï¼‰
node --version

# npm ã¾ãŸã¯ yarn
npm --version

# Git
git --version
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yourname/IdleGame.git
cd IdleGame

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

### æ¨å¥¨ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®š
```json
// .vscode/settings.json
{
  "typescript.preferences.importModuleSpecifier": "relative",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "always"
  }
}
```

### å¿…é ˆæ‹¡å¼µæ©Ÿèƒ½
- **TypeScript Importer** - è‡ªå‹•import
- **ESLint** - ã‚³ãƒ¼ãƒ‰è¦ç´„ãƒã‚§ãƒƒã‚¯
- **Prettier** - ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- **Auto Rename Tag** - HTMLã‚¿ã‚°ç·¨é›†

---

## ğŸ“ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### TypeScriptè¨­å®š
```typescript
// tsconfig.jsonï¼ˆé‡è¦ãªè¨­å®šï¼‰
{
  "compilerOptions": {
    "strict": true,              // å³æ ¼ãƒ¢ãƒ¼ãƒ‰å¿…é ˆ
    "noUnusedLocals": true,      // æœªä½¿ç”¨å¤‰æ•°ã‚¨ãƒ©ãƒ¼
    "noUnusedParameters": true,  // æœªä½¿ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼
    "exactOptionalPropertyTypes": true
  }
}
```

### å‘½åè¦ç´„
```typescript
// âœ… è‰¯ã„ä¾‹
class TeamWorkSystem extends BaseSystem {}          // PascalCase: ã‚¯ãƒ©ã‚¹
interface TaskDefinition {}                        // PascalCase: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
const MAX_TEAM_SIZE = 6                            // UPPER_SNAKE_CASE: å®šæ•°
let currentTaskId: string                          // camelCase: å¤‰æ•°
function calculateTeamEfficiency(): number {}      // camelCase: é–¢æ•°

// âŒ æ‚ªã„ä¾‹
class teamwork_system {}                           // snake_case NG
interface task_definition {}                       // snake_case NG
const maxTeamSize = 6                             // camelCase NGï¼ˆå®šæ•°ï¼‰
let CurrentTaskId: string                         // PascalCase NGï¼ˆå¤‰æ•°ï¼‰
```

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦ç´„
```
âœ… è‰¯ã„ä¾‹:
TeamWorkSystem.ts          // PascalCase: ã‚¯ãƒ©ã‚¹
game-specification.md      // kebab-case: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
team-management.scss       // kebab-case: ã‚¹ã‚¿ã‚¤ãƒ«
buildings.json            // kebab-case: ãƒ‡ãƒ¼ã‚¿

âŒ æ‚ªã„ä¾‹:
teamWorkSystem.ts          // camelCase NG
TeamWorkSystem.scss        // PascalCase NGï¼ˆã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
Buildings.json            // PascalCase NGï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰
```

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¦ç´„
```typescript
// âœ… è‰¯ã„ä¾‹: ãƒ‘ã‚¹åˆ¥ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
// 1. å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import React from 'react'

// 2. å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆ@ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼‰
import { GameManager } from '@core/GameManager'
import { BaseSystem } from '@core/BaseSystem'
import { Character } from '@entities/Character'

// 3. ç›¸å¯¾ãƒ‘ã‚¹
import { TeamData } from './types'
import './TeamManagement.scss'

// âŒ æ‚ªã„ä¾‹: ãƒ©ãƒ³ãƒ€ãƒ é †åº
import './TeamManagement.scss'
import { Character } from '@entities/Character'
import React from 'react'
import { TeamData } from './types'
```

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ã‚¬ã‚¤ãƒ‰

### æ–°ã‚·ã‚¹ãƒ†ãƒ ä½œæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```typescript
// src/systems/NewSystem.ts
import { BaseSystem } from '@core/BaseSystem'
import { EventBus, GameEvents } from '@core/EventBus'

/**
 * æ–°æ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ 
 * è²¬ä»»ç¯„å›²: [å…·ä½“çš„ãªè²¬ä»»ã‚’è¨˜è¿°]
 */
export class NewSystem extends BaseSystem {
  // è‡ªåˆ†ã®è²¬ä»»ç¯„å›²ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ç®¡ç†
  private internalData: Map<string, any> = new Map()
  
  protected async onInitialize(): Promise<void> {
    console.log('NewSystem initialized')
    // åˆæœŸåŒ–å‡¦ç†
  }
  
  protected setupEventListeners(): void {
    // å¿…è¦æœ€å°é™ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿ç›£è¦–
    this.eventBus.on(GameEvents.TIME_HOUR, () => {
      this.processHourlyUpdate()
    })
  }
  
  // === å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ===
  public startFeature(params: any): boolean {
    // å¤–éƒ¨ã‹ã‚‰å‘¼ã³å‡ºã—å¯èƒ½ãªãƒ¡ã‚½ãƒƒãƒ‰
    return true
  }
  
  public getFeatureStatus(id: string): any {
    // çŠ¶æ…‹å–å¾—ãƒ¡ã‚½ãƒƒãƒ‰
    return this.internalData.get(id)
  }
  
  // === å†…éƒ¨å‡¦ç† ===
  private processHourlyUpdate(): void {
    // æ™‚é–“é€²è¡Œæ™‚ã®å‡¦ç†
  }
  
  private calculateInternalLogic(): number {
    // å†…éƒ¨è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
    return 1.0
  }
  
  protected onStart(): void {
    console.log('NewSystem started')
  }
  
  protected onStop(): void {
    console.log('NewSystem stopped')
  }
  
  protected onUpdate(deltaTime: number): void {
    // ãƒ•ãƒ¬ãƒ¼ãƒ æ›´æ–°å‡¦ç†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
  }
  
  protected onDestroy(): void {
    console.log('NewSystem destroyed')
    this.internalData.clear()
  }
}
```

### ã‚·ã‚¹ãƒ†ãƒ ç™»éŒ²
```typescript
// src/main.ts
import { NewSystem } from '@systems/NewSystem'

async function initializeApp() {
  const gameManager = GameManager.getInstance()
  
  // ã‚·ã‚¹ãƒ†ãƒ ã®ç™»éŒ²ï¼ˆé †åºé‡è¦ï¼‰
  gameManager.registerSystem('time', new TimeSystem())
  gameManager.registerSystem('character', new CharacterSystem())
  gameManager.registerSystem('newFeature', new NewSystem()) // æ–°ã‚·ã‚¹ãƒ†ãƒ è¿½åŠ 
  gameManager.registerSystem('ui', new UISystem())
}
```

---

## ğŸ”’ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹æ€§ãƒ«ãƒ¼ãƒ«

### ğŸ¯ ç‹¬ç«‹æ€§ã®åŸå‰‡

**å„ã‚·ã‚¹ãƒ†ãƒ ãŒå®ˆã‚‹ã¹ãçµ¶å¯¾ãƒ«ãƒ¼ãƒ«ï¼š**

#### âœ… çŸ¥ã£ã¦ã„ã„ã‚‚ã®
- **CentralStateManager** - çŠ¶æ…‹ã®å–å¾—ãƒ»å¤‰æ›´
- **EventBus** - ã‚¤ãƒ™ãƒ³ãƒˆé€šä¿¡
- **è‡ªåˆ†ã®å‹å®šç¾©** - è‡ªã‚·ã‚¹ãƒ†ãƒ ç”¨ã®interface/type
- **å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£** - æ—¥ä»˜è¨ˆç®—ã€æ•°å­¦é–¢æ•°ãªã©

#### âŒ çŸ¥ã£ã¦ã¯ã„ã‘ãªã„ã‚‚ã®
- **ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ©ã‚¹** - CombatSystem, ExplorationSystemç­‰
- **ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã®å†…éƒ¨çŠ¶æ…‹** - activeJobs, privateãƒ¡ã‚½ãƒƒãƒ‰ç­‰
- **ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã®å‡¦ç†çµæœ** - æˆ¦é—˜çµæœã€æ¢ç´¢çµæœç­‰

### å®Ÿè£…ä¾‹ï¼šå®Œå…¨ç‹¬ç«‹ãªã‚·ã‚¹ãƒ†ãƒ 
```typescript
// âœ… è‰¯ã„ä¾‹ï¼šå®Œå…¨ç‹¬ç«‹
export class CookingSystem extends BaseSystem {
  private activeJobs: Map<string, CookingJob> = new Map()
  // ã“ã‚Œã ã‘ã‚’çŸ¥ã£ã¦ã„ã‚‹ï¼ˆä»–ã‚·ã‚¹ãƒ†ãƒ ã¯çŸ¥ã‚‰ãªã„ï¼‰
  
  // æ–™ç†å¯èƒ½æ€§ã®åˆ¤å®šï¼ˆä»–ã‚·ã‚¹ãƒ†ãƒ ã‚’çŸ¥ã‚‰ãšã«åˆ¤å®šï¼‰
  canStartCooking(characterId: string, recipeId: string): boolean {
    // ä¸­å¤®ç®¡ç†ã‹ã‚‰å¿…è¦ãªæƒ…å ±ã®ã¿å–å¾—
    const character = this.gameState.getCharacter(characterId)
    const recipe = this.getRecipe(recipeId)
    
    // è‡ªåˆ†ãŒçŸ¥ã‚‹ã¹ãæ¡ä»¶ã®ã¿ãƒã‚§ãƒƒã‚¯
    return (
      !this.activeJobs.has(characterId) &&           // æ—¢ã«æ–™ç†ä¸­ã§ãªã„
      character.status.health > 10 &&                // æœ€ä½é™ã®ä½“åŠ›
      this.gameState.hasResources(recipe.materials) && // ææ–™ãŒã‚ã‚‹
      this.hasRequiredSkill(characterId, recipe)     // ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«ååˆ†
    )
  }
  
  // ä»–ã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ã¯ä¸€åˆ‡è€ƒæ…®ã—ãªã„
  // ã€Œæˆ¦é—˜ä¸­ã‹ã©ã†ã‹ã€ã€Œæ¢ç´¢ä¸­ã‹ã©ã†ã‹ã€ã¯çŸ¥ã‚‰ãªã„ã€çŸ¥ã‚‹å¿…è¦ã‚‚ãªã„
}

// âŒ æ‚ªã„ä¾‹ï¼šä¾å­˜é–¢ä¿‚ã‚ã‚Š
export class BadCookingSystem {
  constructor(
    private combatSystem: CombatSystem,      // ä»–ã‚·ã‚¹ãƒ†ãƒ ã«ä¾å­˜
    private explorationSystem: ExplorationSystem // ä»–ã‚·ã‚¹ãƒ†ãƒ ã«ä¾å­˜
  ) {}
  
  cookFood() {
    // æˆ¦é—˜ä¸­ã¯æ–™ç†ã§ããªã„
    if (this.combatSystem.isInCombat()) {  // ä»–ã‚·ã‚¹ãƒ†ãƒ ã‚’çŸ¥ã£ã¦ã„ã‚‹
      return false
    }
  }
}
```

### ã‚·ã‚¹ãƒ†ãƒ é–“ã®é–“æ¥çš„ãªé€£æº

**å•é¡Œï¼š** ã‚·ã‚¹ãƒ†ãƒ é–“ã§æƒ…å ±ãŒå¿…è¦ãªå ´åˆ  
**è§£æ±ºæ–¹æ³•ï¼š** ä¸­å¤®ç®¡ç†çµŒç”±ã®çŠ¶æ…‹å…±æœ‰

```typescript
// 1. ä¸­å¤®ç®¡ç†ã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®çŠ¶æ…‹ã‚’è¿½åŠ 
class GameState {
  updateCharacterState(characterId: string, state: CharacterState): void {
    // state = 'idle' | 'cooking' | 'fighting' | 'exploring'
    this.characters.get(characterId).currentState = state
  }
  
  getCharacterState(characterId: string): CharacterState {
    return this.characters.get(characterId).currentState
  }
}

// 2. å„ã‚·ã‚¹ãƒ†ãƒ ã¯è‡ªåˆ†ã®çŠ¶æ…‹ã®ã¿æ›´æ–°
class CombatSystem extends BaseSystem {
  startCombat(characterId: string): void {
    // æˆ¦é—˜é–‹å§‹æ™‚ã«çŠ¶æ…‹æ›´æ–°
    this.gameState.updateCharacterState(characterId, 'fighting')
  }
  
  endCombat(characterId: string): void {
    // æˆ¦é—˜çµ‚äº†æ™‚ã«çŠ¶æ…‹æ›´æ–°
    this.gameState.updateCharacterState(characterId, 'idle')
  }
}

class CookingSystem extends BaseSystem {
  canStartCooking(characterId: string): boolean {
    // ä¸­å¤®ç®¡ç†ã‹ã‚‰çŠ¶æ…‹ã‚’å–å¾—ï¼ˆä»–ã‚·ã‚¹ãƒ†ãƒ ã¯çŸ¥ã‚‰ãªã„ï¼‰
    const state = this.gameState.getCharacterState(characterId)
    return state === 'idle' // idleã®æ™‚ã®ã¿æ–™ç†å¯èƒ½
  }
  
  startCooking(characterId: string): void {
    this.gameState.updateCharacterState(characterId, 'cooking')
  }
}
```

### ğŸš« ã‚ˆãã‚ã‚‹ç‹¬ç«‹æ€§é•åãƒ‘ã‚¿ãƒ¼ãƒ³

#### ãƒ‘ã‚¿ãƒ¼ãƒ³1ï¼šç›´æ¥çš„ãªã‚·ã‚¹ãƒ†ãƒ å‚ç…§
```typescript
// âŒ æ‚ªã„ä¾‹
class CookingSystem {
  constructor(
    private combatSystem: CombatSystem,    // ç›´æ¥ä¾å­˜
    private explorationSystem: ExplorationSystem // ç›´æ¥ä¾å­˜
  ) {}
  
  canCook(characterId: string): boolean {
    return !this.combatSystem.isInCombat(characterId) // ç›´æ¥å‚ç…§
  }
}

// âœ… è‰¯ã„ä¾‹
class CookingSystem extends BaseSystem {
  canCook(characterId: string): boolean {
    const state = this.gameState.getCharacterState(characterId)
    return state === 'idle'
  }
}
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³2ï¼šã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã®ç›´æ¥å¤‰æ›´
```typescript
// âŒ æ‚ªã„ä¾‹
class CookingSystem {
  cookFood() {
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’ç›´æ¥å¤‰æ›´
    window.gameState.resources.wheat -= 2
    window.gameState.characters.char1.hunger -= 50
  }
}

// âœ… è‰¯ã„ä¾‹
class CookingSystem extends BaseSystem {
  cookFood() {
    // ä¸­å¤®ç®¡ç†çµŒç”±ã§å¤‰æ›´
    this.gameState.removeResource('wheat', 2)
    this.gameState.updateCharacterStatus('char1', { hunger: -50 })
  }
}
```

---

## ğŸ¨ UIé–‹ç™ºã‚¬ã‚¤ãƒ‰

### UIComponentåŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// src/ui/components/NewComponent.ts
import { UIComponent } from '@ui/UIManager'
import { NewSystem } from '@systems/NewSystem'
import { GameManager } from '@core/GameManager'
import { EventBus, GameEvents } from '@core/EventBus'

export class NewComponent implements UIComponent {
  element: HTMLElement
  private newSystem: NewSystem | null = null
  private eventBus: EventBus
  
  constructor(element: HTMLElement) {
    this.element = element
    this.eventBus = EventBus.getInstance()
  }
  
  initialize(): void {
    // ã‚·ã‚¹ãƒ†ãƒ å–å¾—ï¼ˆç›´æ¥å‚ç…§ã¯ã—ãªã„ï¼‰
    const gameManager = GameManager.getInstance()
    this.newSystem = gameManager.getSystem<NewSystem>('newFeature')
    
    this.render()
    this.setupEventListeners()
    this.update()
  }
  
  private render(): void {
    this.element.innerHTML = `
      <div class="new-component">
        <h3>æ–°æ©Ÿèƒ½</h3>
        <button id="feature-btn">æ©Ÿèƒ½å®Ÿè¡Œ</button>
        <div id="status-display"></div>
      </div>
    `
  }
  
  private setupEventListeners(): void {
    // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
    const button = document.getElementById('feature-btn')
    if (button) {
      button.addEventListener('click', () => {
        if (this.newSystem) {
          this.newSystem.startFeature({})
        }
      })
    }
    
    // ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ
    this.eventBus.on('NEW_FEATURE_UPDATE', (data) => {
      this.updateDisplay(data)
    })
  }
  
  private updateDisplay(data: any): void {
    const statusDisplay = document.getElementById('status-display')
    if (statusDisplay) {
      statusDisplay.textContent = `Status: ${data.status}`
    }
  }
  
  update(): void {
    // å®šæœŸçš„ãªUIæ›´æ–°
  }
  
  destroy(): void {
    this.element.innerHTML = ''
  }
}
```

### CSSè¨­è¨ˆã‚¬ã‚¤ãƒ‰
```scss
// src/styles/new-component.scss

// BEMè¨˜æ³•ã‚’ä½¿ç”¨
.new-component {
  // ãƒ™ãƒ¼ã‚¹
  &__header {
    // ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ
  }
  
  &--active {
    // ãƒ¢ãƒ‡ã‚£ãƒ•ã‚¡ã‚¤ã‚¢
  }
  
  &__button {
    // ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ
    
    &:hover {
      // ç–‘ä¼¼ã‚¯ãƒ©ã‚¹
    }
    
    &--disabled {
      // ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®ãƒ¢ãƒ‡ã‚£ãƒ•ã‚¡ã‚¤ã‚¢
    }
  }
}

// æ—¢å­˜ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨
.new-component {
  @extend .card; // æ—¢å­˜ã®ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
  
  .btn {
    @extend .btn--primary; // æ—¢å­˜ã®ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«
  }
}
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°

### ç‹¬ç«‹æ€§æ¤œè¨¼ãƒ„ãƒ¼ãƒ«
```typescript
// scripts/checkIndependence.ts
export function checkSystemIndependence(systemPath: string): IndependenceReport {
  const sourceCode = fs.readFileSync(systemPath, 'utf8')
  const violations: string[] = []
  
  // ä»–ã‚·ã‚¹ãƒ†ãƒ ã®importã‚’ãƒã‚§ãƒƒã‚¯
  const forbiddenImports = [
    '../combat/', '../exploration/', '../building/',
    'CombatSystem', 'ExplorationSystem', 'BuildingSystem'
  ]
  
  forbiddenImports.forEach(forbidden => {
    if (sourceCode.includes(forbidden)) {
      violations.push(`Forbidden import detected: ${forbidden}`)
    }
  })
  
  // ç›´æ¥çš„ãªçŠ¶æ…‹å¤‰æ›´ã‚’ãƒã‚§ãƒƒã‚¯
  const directStateChanges = [
    '.health =', '.mana =', '.resources.',
    'window.gameState', 'globalState'
  ]
  
  directStateChanges.forEach(direct => {
    if (sourceCode.includes(direct)) {
      violations.push(`Direct state change detected: ${direct}`)
    }
  })
  
  return {
    isIndependent: violations.length === 0,
    violations
  }
}
```

### ä½¿ç”¨ä¾‹
```bash
# å…¨ã‚·ã‚¹ãƒ†ãƒ ã®ç‹¬ç«‹æ€§ãƒã‚§ãƒƒã‚¯
npm run check:independence

# çµæœä¾‹
âœ… CookingSystem: Independent
âŒ CombatSystem: 2 violations found
  - Forbidden import: ../exploration/ExplorationSystem
  - Direct state change: character.health =
```

### ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ„ãƒ¼ãƒ«
```typescript
// é–‹ç™ºç’°å¢ƒã§ã®ãƒ‡ãƒãƒƒã‚°ã‚µãƒãƒ¼ãƒˆ
if (import.meta.env?.DEV) {
  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
  (window as any).gameManager = gameManager
  (window as any).gameState = gameState
  
  // ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼
  (window as any).debug = {
    // ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
    getSystemStatus: () => {
      const systems = gameManager.getAllSystems()
      return systems.map(system => ({
        name: system.constructor.name,
        initialized: system.isInitialized,
        running: system.isRunning
      }))
    },
    
    // ç‹¬ç«‹æ€§ãƒã‚§ãƒƒã‚¯
    checkIndependence: (systemName: string) => {
      return checkSystemIndependence(`./src/systems/${systemName}.ts`)
    }
  }
}
```

---

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ãƒ¡ãƒ¢ãƒªç®¡ç†
```typescript
// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®é©åˆ‡ãªç®¡ç†
class MyComponent implements UIComponent {
  private eventSubscriptions: EventSubscription[] = []
  
  initialize(): void {
    // ç™»éŒ²æ™‚ã«subscriptionã‚’ä¿å­˜
    this.eventSubscriptions.push(
      this.eventBus.on(GameEvents.UPDATE, () => this.handleUpdate())
    )
  }
  
  destroy(): void {
    // ç¢ºå®Ÿã«è§£é™¤
    this.eventSubscriptions.forEach(sub => sub.unsubscribe())
    this.eventSubscriptions = []
  }
}
```

### æ›´æ–°é »åº¦åˆ¶å¾¡
```typescript
// ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†
private debouncedUpdate(): void {
  if (this.updateTimeout) {
    clearTimeout(this.updateTimeout)
  }
  
  this.updateTimeout = window.setTimeout(() => {
    this.update()
    this.updateTimeout = null
  }, 100) // 100msã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹
}

// ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°å‡¦ç†
private throttledUpdate = throttle(() => {
  this.update()
}, 16) // 60FPSåˆ¶é™
```

---

## ğŸ” å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ–°æ©Ÿèƒ½å®Ÿè£…æ™‚ã®ãƒã‚§ãƒƒã‚¯é …ç›®
- [ ] ã‚·ã‚¹ãƒ†ãƒ ã¯ä»–ã‚·ã‚¹ãƒ†ãƒ ã‚’ç›´æ¥å‚ç…§ã—ã¦ã„ãªã„ã‹
- [ ] çŠ¶æ…‹å¤‰æ›´ã¯GameStateçµŒç”±ã§è¡Œã£ã¦ã„ã‚‹ã‹
- [ ] ã‚¤ãƒ™ãƒ³ãƒˆé€šä¿¡ã¯é©åˆ‡ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] å‹å®šç¾©ã¯æ˜ç¢ºã§å®‰å…¨ã‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯é©åˆ‡ã‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å•é¡Œã¯ãªã„ã‹
- [ ] UIã¯æ—¢å­˜ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹

### ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹
- **è¨­è¨ˆåŸå‰‡:** ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«æº–æ‹ ã—ã¦ã„ã‚‹ã‹
- **ã‚³ãƒ¼ãƒ‰å“è³ª:** å¯èª­æ€§ãƒ»ä¿å®ˆæ€§ã¯ååˆ†ã‹
- **å‹å®‰å…¨æ€§:** TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã—ã¦ã„ã‚‹ã‹
- **ç‹¬ç«‹æ€§:** ã‚·ã‚¹ãƒ†ãƒ é–“ã®ä¾å­˜é–¢ä¿‚ã¯é©åˆ‡ã‹
- **ãƒ†ã‚¹ãƒˆ:** å¿…è¦ãªãƒ†ã‚¹ãƒˆã¯å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹

---

## ğŸ“š å‚è€ƒè³‡æ–™

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [game-specification.md](./game-specification.md) - ã‚²ãƒ¼ãƒ ä»•æ§˜
- [architecture.md](./architecture.md) - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
- [README.md](./README.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [Clean Code JavaScript](https://github.com/ryanmcdermott/clean-code-javascript)
- [BEM Methodology](https://en.bem.info/methodology/)

---

**æœ€çµ‚æ›´æ–°ï¼š** 2024å¹´6æœˆ23æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼š** 2.0.0ï¼ˆãƒãƒ¼ãƒ ç®¡ç†æ©Ÿèƒ½å¯¾å¿œç‰ˆï¼‰  
**ãƒ¡ãƒ³ãƒ†ãƒŠãƒ¼ï¼š** é–‹ç™ºãƒãƒ¼ãƒ   
**æ¬¡å›æ›´æ–°äºˆå®šï¼š** æ–°æ©Ÿèƒ½è¿½åŠ æ™‚