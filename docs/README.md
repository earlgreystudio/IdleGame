# 異世界Idleゲーム - ドキュメント

## 📚 このドキュメントの目的

**このディレクトリは何のためにあるのか：**
- プロジェクトに関するすべての重要な情報を一元管理する
- 開発者、企画者、デザイナーが共通の理解を持てるようにする
- 新しいメンバーがプロジェクトを理解できるように案内する
- 長期的なプロジェクト保守のための知識ベースとして機能する

**誰が使うのか：**
- **開発者** - 実装時の仕様確認・設計参照
- **プロジェクトマネージャー** - 進捗確認・仕様変更の影響評価
- **新規参加者** - プロジェクト理解・開発環境構築
- **レビュアー** - コード品質確認・設計整合性チェック

**いつ参照するのか：**
- プロジェクトに新しく参加する時
- 新機能を企画・実装する時
- 既存機能を変更・修正する時
- コードレビューを行う時
- 障害調査・デバッグを行う時

---

## 📂 ドキュメント構成

この`docs/`フォルダには、プロジェクトの**必須文書4つ**のみが含まれています：

### 📋 [game-specification.md](./game-specification.md)
**役割：** ゲームの全体仕様を定義する最重要文書

**含まれる内容：**
- ゲームコンセプト・世界観
- キャラクターシステム（ステータス、スキル、部活）
- チーム・タスクシステム（現在の中核機能）
- 拠点システム（建物、アップグレード）
- リソース・経済システム
- UI/UX設計
- 実装フェーズ計画

**いつ読む：** 新機能企画時、仕様確認時、ゲームバランス調整時

### 🏗️ [architecture.md](./architecture.md)
**役割：** システム設計と技術アーキテクチャを定義

**含まれる内容：**
- 設計原則（完全独立コンポーネント・中央状態管理）
- システム階層構造・フォルダ構成
- 中央管理システム（GameManager, GameState, EventBus）
- 独立システム設計パターン
- データフロー・パフォーマンス設計
- 拡張性・品質保証

**いつ読む：** システム実装時、アーキテクチャ変更時、パフォーマンス改善時

### 👨‍💻 [development-guide.md](./development-guide.md)
**役割：** 開発者向けの実装ガイド・コーディング規約

**含まれる内容：**
- 開発環境セットアップ
- コーディング規約（命名、インポート、ファイル構成）
- システム実装テンプレート
- コンポーネント独立性ルール（重要）
- UI開発ガイド
- テスト・デバッグ方法
- パフォーマンス最適化

**いつ読む：** 開発環境構築時、新システム実装時、コードレビュー時

### 📖 [README.md](./README.md) ←このファイル
**役割：** ドキュメント全体の案内・プロジェクト概要

**含まれる内容：**
- ドキュメント構成の説明
- 各文書の役割・使い方
- 開発フロー・ワークフロー
- 緊急時の対応方法

---

## 🔄 開発ワークフロー

### 新機能開発時の推奨手順

1. **📋 仕様確認**
   ```
   game-specification.md を読む
   → 既存仕様との整合性確認
   → 必要に応じて仕様書を更新
   ```

2. **🏗️ 設計確認**
   ```
   architecture.md を読む
   → システム設計原則に従っているか確認
   → 独立性ルールを守れるか検討
   ```

3. **👨‍💻 実装**
   ```
   development-guide.md を参照
   → 実装テンプレートを使用
   → コーディング規約に従って実装
   ```

4. **✅ レビュー**
   ```
   development-guide.md のチェックリスト確認
   → 独立性ルール遵守確認
   → パフォーマンス・品質確認
   ```

### 既存機能修正時の推奨手順

1. **📋 仕様影響範囲確認**
   ```
   game-specification.md で関連機能確認
   → 変更による影響範囲の特定
   ```

2. **🏗️ 設計整合性確認**
   ```
   architecture.md で設計原則確認
   → システム間依存関係の影響評価
   ```

3. **👨‍💻 実装・テスト**
   ```
   development-guide.md の品質基準に従って修正
   → 独立性を損なわないように注意
   ```

---

## ⚠️ 重要な設計原則（必読）

### 🔒 完全独立コンポーネント
**最重要ルール：** 各システムは他システムの存在を知らない

```typescript
// ✅ 良い例：完全独立
class CookingSystem extends BaseSystem {
  // GameStateとEventBusのみ知っている
  // CombatSystemやExplorationSystemは知らない
}

// ❌ 悪い例：他システムに依存
class BadCookingSystem {
  constructor(private combatSystem: CombatSystem) {} // NG
}
```

### 🎯 中央状態管理
**ルール：** すべての状態変更はGameState経由で行う

```typescript
// ✅ 良い例：中央管理経由
this.gameState.removeResource('wheat', 2)
this.gameState.updateCharacterStatus(characterId, { health: -10 })

// ❌ 悪い例：直接変更
character.health -= 10  // NG
window.gameState.resources.wheat -= 2  // NG
```

### 📡 イベント駆動通信
**ルール：** システム間の連携はEventBus経由のみ

```typescript
// ✅ 良い例：イベント通信
this.eventBus.emit(GameEvents.TASK_COMPLETE, { teamId, taskName })
this.eventBus.on(GameEvents.TIME_HOUR, () => this.processWork())

// ❌ 悪い例：直接呼び出し
this.combatSystem.startCombat()  // NG
```

---

## 🆘 困った時の対処法

### ドキュメントが見つからない・古い場合
```
1. 最新版確認：git pull origin main
2. 文書の日付確認：ファイル末尾の「最終更新」を確認
3. 不明点があれば：GitHubのIssueに質問投稿
```

### 実装方法がわからない場合
```
1. development-guide.md の実装テンプレート確認
2. 既存の類似システム（TeamWorkSystem等）を参考
3. architecture.md で設計原則を再確認
```

### システム設計で迷った場合
```
1. 「このシステムは他のシステムを知るべきか？」→ NO
2. 「状態変更は中央管理経由か？」→ YES
3. 「独立性ルールを守れているか？」→ 必須チェック
```

### エラー・バグが発生した場合
```
1. development-guide.md のデバッグ方法確認
2. 独立性チェックツール実行：npm run check:independence
3. ブラウザの開発者ツールでwindow.gameManagerを確認
```

---

## 📊 プロジェクト現状（2024年6月23日時点）

### ✅ 実装済み機能
- **キャラクター管理** - 部活別キャラクター生成・ステータス管理
- **チーム編成** - ドラッグ&ドロップによるチーム配置
- **タスクシステム** - 8種類の作業（料理・戦闘・探索・建設）
- **時間進行** - 1時間単位での作業進行
- **効率計算** - スキル・チームサイズ・ステータスによる効率変動
- **リアルタイムUI** - プログレスバー・ステータス表示

### 🚧 実装中機能（Phase 1）
- 拠点建設システム
- セーブ・ロード機能

### 📋 今後の予定
- **Phase 2:** ガチャ・戦闘・取引システム
- **Phase 3:** コンテンツ拡張
- **Phase 4:** 収益化・配信

---

## 🔧 メンテナンス

### ドキュメント更新タイミング
- **仕様変更時：** game-specification.md を即座に更新
- **アーキテクチャ変更時：** architecture.md を更新
- **新規コーディング規約時：** development-guide.md を更新
- **ファイル構成変更時：** README.md を更新

### 品質維持
- 定期的な独立性チェック実行
- 新機能追加時の設計レビュー
- ドキュメントと実装の整合性確認

---

## 📞 サポート・質問

### 質問・要望がある場合
1. **GitHub Issues** - 機能要望・バグ報告
2. **コードレビュー** - 実装方法の相談
3. **ドキュメント改善** - 分かりにくい点の指摘

### 貢献方法
1. ドキュメントの誤字・改善提案
2. 実装テンプレートの改良
3. チェックツールの機能拡張

---

## 📋 ドキュメント履歴

| バージョン | 日付 | 変更内容 | 変更者 |
|-----------|------|----------|--------|
| 2.0.0 | 2024-06-23 | 4ファイル構成に再編、チーム管理機能対応 | 開発チーム |
| 1.0.0 | 2024-06-22 | 初期版作成 | 開発チーム |

---

**最終更新：** 2024年6月23日  
**バージョン：** 2.0.0（整理統合版）  
**ステータス：** メンテナンス中  
**次回レビュー予定：** Phase 1完了時（拠点システム実装後）